<ContentPage
    x:Class="SMA.Pages.MainPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Steam Desktop Authenticator"
    BackgroundColor="#232323">
    



    <Grid RowDefinitions="Auto, Auto, Auto, *, Auto, Auto" Padding="10">

        <!-- Верхнее меню -->

        <Button Text="Menu" Clicked="OnMenuClicked" HorizontalOptions="FillAndExpand"  Margin="0,10,0,10"/>

        <Grid Grid.Row="1" ColumnDefinitions="*,*" ColumnSpacing="10">
            <Button x:Name="btnSteamLogin"
                    Text="Setup New Account"
                    Clicked="OnSteamLoginClicked" Grid.Column="0"/>
            
            <Button x:Name="btnManageEncryption"
                    Text="Manage Encryption"
                    Clicked="OnManageEncryptionClicked" Grid.Column="1"/>
        </Grid>

        <!-- Блок с кодом -->
        <Frame Grid.Row="2" Margin="0,10,0,0" BorderColor="Gray" CornerRadius="10" BackgroundColor="#232323">
            <VerticalStackLayout Padding="10">
                <Label Text="Login Token" FontAttributes="Bold"/>
                <Entry x:Name="txtLoginToken"
                       IsReadOnly="True"
                       HorizontalTextAlignment="Center"
                       FontSize="24"/>
                <ProgressBar x:Name="pbTimeout"
                             Progress="1"
                             HeightRequest="10"
                             Margin="0,5,0,0"/>
                <Button Text="Copy" Clicked="OnCopyClicked"/>
            </VerticalStackLayout>
        </Frame>

        <!-- Список аккаунтов -->
        <Frame Grid.Row="3" Margin="0,10,0,0" BorderColor="Gray" CornerRadius="10" BackgroundColor="#232323">
            <Grid RowDefinitions="auto, *">
                <Label Text="Accounts" FontAttributes="Bold" Grid.Row="0"/>
                <CollectionView x:Name="listAccounts"
                    SelectionMode="Single"
                    SelectionChanged="OnAccountSelected" Margin="10" Grid.Row="1">

                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Padding="10" CornerRadius="20" Margin="10">
                                <Frame.GestureRecognizers>
                                    <TapGestureRecognizer Tapped="OnItemFrameTapped" NumberOfTapsRequired="1"/>
                                </Frame.GestureRecognizers>
                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroup Name="CommonStates">
                                        <VisualState Name="Normal">
                                            <VisualState.Setters>
                                                <Setter Property="BackgroundColor"
                        Value="Transparent" />
                                            </VisualState.Setters>
                                        </VisualState>

                                        <VisualState Name="Selected">
                                            <VisualState.Setters>
                                                <Setter Property="BackgroundColor"
                        Value="#80FFFFFF" />
                                            </VisualState.Setters>
                                        </VisualState>
                                    </VisualStateGroup>
                                </VisualStateManager.VisualStateGroups>

                                <Label Text="{Binding AccountName}" Padding="10"/>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </Grid>
        </Frame>

        <!-- Нижняя панель -->
        <Grid Grid.Row="4" ColumnDefinitions="Auto,*" Margin="0,10,0,0">
            <Label Text="Filter:" VerticalOptions="Center"/>
            <Entry x:Name="txtAccSearch" Grid.Column="1"
                   Placeholder="Search..."
                   TextChanged="OnSearchChanged" Margin="50, 0, 0, 0" HorizontalOptions="FillAndExpand"/>
        </Grid>

        <!-- Нижняя информация -->
        <Grid Grid.Row="5" ColumnDefinitions="*,Auto" Margin="0,5,0,0">

            <Label x:Name="labelVersion"
                   Text="v0.0.0"
                   FontSize="10"
                   TextColor="Gray"
                   HorizontalOptions="End"
                   VerticalOptions="Center"/>
        </Grid>

        <!-- Статус -->
        <Label x:Name="lblStatus"
               Grid.Row="0"
               HorizontalOptions="End"
               TextColor="Gray"
               FontSize="12"
               Margin="0,30,0,0"/>

    </Grid>
</ContentPage>
